<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>
    Don't start with a Monolith - ciandcd</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="http://www.ciandcd.com/theme/css/bootstrap.css" rel="stylesheet" type="text/css"/>
  <link href="http://www.ciandcd.com/theme/css/main.css" rel="stylesheet" type="text/css"/>
  <link href="http://www.ciandcd.com/theme/css/pygment.css" rel="stylesheet" type="text/css"/>
  <link href="http://fonts.googleapis.com/css?family=Chelsea+Market" rel="stylesheet" type="text/css"/>
<link href="http://www.ciandcd.com/feeds/rss.xml" rel="alternate" type="application/atom+xml" title="ciandcd RSS" />


  <!--[if lt IE 9]>
    <script src="https://raw.github.com/aFarkas/html5shiv/master/dist/html5shiv.js"></script>
  <![endif]-->
</head>

<!--
bootstrap-itech - a Pelican theme using Bootstrap
-->
<body>

<!-- Header -->
<header>
<div class="container-fluid">
<h1 class="page-header"><a href="http://www.ciandcd.com/index.html">ciandcd </a>
<h4>continuous integration and continuous delivery</h4></h1>
</div>
</header>
<!-- /Header -->

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://www.ciandcd.com/index.html"></a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
  <li><a href="http://www.ciandcd.com/index.html">Home</a></li>



      </ul>
      <form class="navbar-form navbar-left" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>
      </form>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="http://www.cnblogs.com/itech">itech</a></li>
        <li><a href="https://github.com/ciandcd">Github</a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<!-- Body -->
<section id="body">
<div class="container-fluid">

<!-- Nav bar -->
<!-- /Nav bar -->

<!-- Main block -->
<div class="row">

<!-- Content -->
<div class="col-lg-9">
<article>
<h1>
    Don't start with a Monolith</h1>

<div><p class="subtitle">&#8230; when your goal is a microservices
  architecture</p><p>Stefan Tilkov is a co-founder and principal consultant at innoQ , a technology consulting company with offices in Germany and Switzerland. He has been involved in the design of large-scale, distributed systems for more than two decades, using a variety of technologies and tools ranging from C++ and CORBA over J2EE/Java EE and Web Services to REST and Ruby on Rails. He has authored numerous articles and a book (&#8220; REST und HTTP &#8221;, German), and is a frequent speaker at conferences around the world.</p><p> In the last few months, I&#8217;ve heard repeatedly that the only way to
get to a successful microservices architecture is by starting with a
monolith first. <a href="http://www.codingthearchitecture.com/2014/07/06/distributed_big_balls_of_mud.html">To
paraphrase Simon Brown</a>: If you can&#8217;t build a well-structured
monolith, what makes you think you can build a well-structured set of
microservices? The most recent &#8211; and, as usual, very convincing &#8211;
rendering of this argument comes from <a href="/bliki/MonolithFirst.html">Martin Fowler</a> on this very site. As I had
a chance to comment on an earlier draft, I had some time to think
about this. And I did, especially because I usually find myself in
agreement with him, and some others whose views I typically share
seemed to agree with him, too.
</p>

<p>I&#8217;m firmly convinced that starting with a monolith is usually exactly the
wrong thing to do. 
</p>

<p>Starting to build a new system is exactly the time when you should
be thinking about carving it up into pieces. I strongly disagree with
the idea that you can postpone this, as expressed by Sam Newman, again
someone I agree with 95% of the time:
</p>

<blockquote>
<p>I remain convinced that it is much easier to partition an existing,
  "brownfield" system than to do so up front with a new, greenfield
  system. You have more to work with. You have code you can examine,
  you can speak to people who use and maintain the system. You also
  know what 'good' looks like - you have a working system to change,
  making it easier for you to know when you may have got something
  wrong or been too aggressive in your decision making process.</p>

<p class="quote-attribution"><a href="http://samnewman.io/blog/2015/04/07/microservices-for-greenfield">-- Sam Newman</a></p>
</blockquote>

<p>In the majority of cases, it will be awfully hard, if not outright
impossible, to cut up an existing monolith this way. (That doesn&#8217;t
mean it&#8217;s always impossible, but that&#8217;s a topic for a future post.)
There is some common ground in that I agree you should know the domain
you&#8217;re building a system for very well before trying to partition
it, though: In my view, the ideal scenario is one where you&#8217;re building a
<i>second version</i> of an existing system.
</p>

<p>If you are actually able to build a well-structured monolith, you
probably don&#8217;t need microservices in the first place. Which is OK! I
definitely agree with <a href="/bliki/MicroservicePremium.html">Martin</a>: You shouldn&#8217;t introduce the
complexity of additional distribution into your system if you don&#8217;t
have a very good reason for doing so.
</p>

<p>(So what would be a good reason? There are many, but to me the most
important one is to allow for fast, independent delivery of individual parts within a larger
system. Microservices&#8217; main benefit, in my view, is enabling parallel
development by establishing a hard-to-cross boundary between different
parts of your system. By doing this, you make it hard &#8211; or at least
harder &#8211; to do the wrong thing: Namely, connecting parts that shouldn&#8217;t
be connected, and coupling those that need to be connected too
tightly. In theory, you don&#8217;t need microservices for this if you
simply have the discipline to follow clear rules and establish clear
boundaries within your monolithic application; in practice, I&#8217;ve found
this to be the case only very rarely.)</p>

<img src="dont-start-monolith/monolith-theory-practice.svg" width="100%">
<p class="photoCaption">
  You might be tempted to assume there are a number of nicely
  separated microservices hiding in your monolith, just waiting to be
  extracted. In reality, though, it&#8217;s extremely hard to avoid creating
  lots of connections, planned and unplanned. In fact the whole point
  of the microservices approach is to make it hard to create something
  like this.
</p>
<p>
But if you start with a monolith, the parts will become extremely
tightly coupled to each other. <i>That&#8217;s the very definition of a
monolith</i>. The parts will rely on features of the platform they all
use. They&#8217;ll communicate based on abstractions that are shared because
they all use the same libraries. They&#8217;ll communicate using means that
are only available when they are hosted in the same process. And these
are only the technical aspects! Far worse than that, the parts will
(almost) freely share domain objects, rely on the same, shared
persistence model, assume database transactions are readily available
so that there&#8217;s no need for compensation &#8230; Even the very fact that
it&#8217;s easy to refactor things and move them around &#8211; all in the
convenience of your IDE&#8217;s view of a single project &#8211; is what makes it
extremely hard to cut things apart again. It&#8217;s <i>extremely</i> hard to
split up an existing monolith into separate pieces.
</p>

<p>
I strongly believe &#8211; and experience from a number of our recent projects
confirms this &#8211; that when you start out, you should think about
the subsystems you build, <i>and build them as independently of each
other as possible</i>. Of course you should only do this if you believe
your system is large enough to warrant this. If it&#8217;s just you and one
of your co-workers building something over the course of a few weeks,
it&#8217;s entirely possible that you don&#8217;t.
</p>

<p>But starting with an approach where you carve up your system into
smaller parts, and treat each of them as a clearly separated, individual
system with its own development, deployment, and delivery cycle, and (the
possibility of) its own internal architecture, is a very powerful
concept that can help you to deliver a system in the first place.
</p>

<p>So is there any actual experience to back this up? Yes, there are a few systems we&#8217;ve been
involved with recently that showed this concept to work &#8211; provided you
tolerate the fact that what I&#8217;m talking about is more likely bigger
than your typical microservice. The most prominent
one is Otto.de, about which I did
<a href="http://www.infoq.com/presentations/modular-ecommerce-website">a talk together with their tech lead</a>
 (and which you can read about (in German) in
 <a href="http://www.informatik-aktuell.de/entwicklung/methoden/von-monolithen-und-microservices.html">this nice write-up by one of their lead architects</a>).
 But there are quite a few others as well, and I remain convinced it&#8217;s
 a good idea to start building a system using this approach &#8211;
 given you know the domain you&#8217;re building for really, really well.
</p>

<p>But there is another lesson to be learned from this discussion, in my
view &#8211; and it&#8217;s a more general one: Beware of architectural recipes
that are too simple and too obvious. This one &#8211; start by carving up
your domain into separate, independent parts &#8211; is no
exception. Sometimes a monolith <i>is</i> preferable, sometime it&#8217;s
not. If you decide to build things using a microservices approach, you
need to be aware that while it will be a lot easier to make localized
decisions in each individual part, it will be much harder to change
the very boundaries that enable this. Refactoring in the small becomes
easier, refactoring in the large becomes much harder. 
</p>

<p>As is always the case with architecture discussions, there is no way
to get around the fact that you need to make that decision on your
own, in each and every individual case.
</p>



<p class="shares">Share: <a href="https://twitter.com/intent/tweet?url=http://martinfowler.com/articles/dont-start-monolith.html&amp;text=Don%E2%80%99t%20start%20with%20a%20monolith" title="Share on Twitter"><img src="/t_mini-a.png"></a><a href="https://facebook.com/sharer.php?u=http://martinfowler.com/articles/dont-start-monolith.html" title="Share on Facebook"><img src="/fb-icon-20.png"></a><a href="https://plus.google.com/share?url=http://martinfowler.com/articles/dont-start-monolith.html" title="Share on Google Plus"><img src="/gplus-16.png"></a></p>

<h2>For articles on similar topics&#8230;</h2>

<p>&#8230;take a look at the tag: </p>
</div>

<p class="info">
Posted Sun 21 June 2015
 by <a class="url fn" href="http://www.ciandcd.com/author/itech001.html">itech001</a>
in <a href="http://www.ciandcd.com/category/devops.html">devops</a>
</p>

</article>
</div>
<!-- /Content -->

<!-- Side bar -->
<nav class="col-lg-3">

<h2>Categories</h2>
<ul class="nav nav-pills nav-stacked">
  <li ><a href="http://www.ciandcd.com/category/ciandcd.html">ciandcd</a></li>
  <li class="active"><a href="http://www.ciandcd.com/category/devops.html">devops</a></li>
  <li ><a href="http://www.ciandcd.com/category/scm.html">scm</a></li>
  <li ><a href="http://www.ciandcd.com/category/zhong-wen.html">中文</a></li>
</ul>

<h2>Links</h2>
<ul class="nav nav-pills nav-stacked">
  <li><a href="http://www.cnblogs.com/itech/">itech</a></li>
</ul>

<h2>Social</h2>
<ul class="nav nav-pills nav-stacked">
  <li><a href="http://www.ciandcd.com/feeds/rss.xml" type="application/rss+xml" rel="alternate">Site Feed</a></li>

  <li><a href="https://github.com/ciandcd">GITHUB</a></li>
</ul>

</nav>
<!-- /Side bar -->

</div>
<!-- /Main block -->

<!-- Footer -->
<div class="row"><div class="col-lg-12">
<footer><small>
Built using <a href="http://pelican.notmyidea.org/">Pelican</a> and
<a href="http://twitter.github.com/bootstrap">Bootstrap</a>.
</small></footer>
</div></div>
<!-- /Footer -->

</div></section>
<!-- /Body -->

<script src="http://www.ciandcd.com/theme/js/jquery.js"></script>
<script src="http://www.ciandcd.com/theme/js/bootstrap.js"></script>


</body>
</html>