<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>
    20个有用的linux命令行技巧 - iTech - ciandcd</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="./theme/css/bootstrap.css" rel="stylesheet" type="text/css"/>
  <link href="./theme/css/main.css" rel="stylesheet" type="text/css"/>
  <link href="./theme/css/pygment.css" rel="stylesheet" type="text/css"/>
  <link href="http://fonts.googleapis.com/css?family=Chelsea+Market" rel="stylesheet" type="text/css"/>
  <link rel="stylesheet" type="text/css" href="./theme/tipuesearch/tipuesearch.css" media="screen">
<link href="./feeds/rss.xml" rel="alternate" type="application/atom+xml" title="ciandcd RSS" />


  <!--[if lt IE 9]>
    <script src="https://raw.github.com/aFarkas/html5shiv/master/dist/html5shiv.js"></script>
  <![endif]-->
</head>

<!--
bootstrap-itech - a Pelican theme using Bootstrap
-->
<body>

<!-- Header -->
<header>
<div class="container-fluid">
<h1 class="page-header"><a href="./index.html">ciandcd </a>
<h4>软件持续集成和持续发布 QQ群：172758282，437085002</h4></h1>
</div>
</header>
<!-- /Header -->

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="./index.html"></a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

  <li><a href="./index.html">首页</a></li>

  <li ><a href="./category/ciandcd.html">ciandcd</a></li>
  <li ><a href="./category/devops.html">devops</a></li>
  <li ><a href="./category/scm.html">scm</a></li>
  <li class="active"><a href="./category/zhong-wen.html">中文</a></li>

  
    <li ><a href="./pages/guan-yu.html">关于</a></li>
    <li ><a href="./pages/awesome.html">Awesome</a></li>


</ul>
      <form class="navbar-form navbar-left navbar-search" role="search" action="./search.html onsubmit="return validateForm(this.elements['q'].value);">
        <div class="form-group search-query">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input">
        </div>
      </form>

      <ul class="nav navbar-nav navbar-right">
        <li><a href="http://www.cnblogs.com/itech">itech</a></li>
        <li><a href="https://github.com/ciandcd">Github</a></li>
      </ul>

    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<!-- Body -->
<section id="body">
<div class="container-fluid">

<!-- Nav bar -->
<!-- /Nav bar -->

<!-- Main block -->
<div class="row">

<!-- Content -->
<div class="col-lg-9">
<article>

from:http://www.cnblogs.com/itech/p/4512113.html<br><div><p>&#160;</p>&#13;
<h2>Deleting a HUGE file</h2>&#13;
<p>I had a huge log file 200GB I need to delete on a production web server. My rm and ls command was crashed and I was afraid that the system to a crawl with huge disk I/O load. To remove a HUGE file, enter:</p>&#13;
<pre class="bash">&gt; /path/to/file.log&#13;
# or use the following syntax&#13;
: &gt; /path/to/file.log&#13;
&#160;&#13;
# finally delete it &#13;
rm /path/to/file.log&#13;
&#160;</pre>&#13;
<h2>Want to cache console output?</h2>&#13;
<p>Try the&#160;script&#160;command line utility to create a typescript of everything printed on your terminal.</p>&#13;
<pre class="bash">script my.terminal.sessio</pre>&#13;
<p>Type commands:</p>&#13;
<pre class="bash">ls&#13;
date&#13;
sudo service foo stop</pre>&#13;
<p>To exit (to end script session) type&#160;exit&#160;or&#160;logout&#160;or press&#160;control-D</p>&#13;
<pre class="bash">exit</pre>&#13;
<p>To view type:</p>&#13;
<pre class="bash">&#160;&#13;
more my.terminal.session&#13;
less my.terminal.session&#13;
cat my.terminal.session&#13;
&#160;</pre>&#13;
<h2>Restoring deleted /tmp folder</h2>&#13;
<p>As my journey continues with&#160;<a href="http://www.cyberciti.biz/tips/my-10-unix-command-line-mistakes.html">Linux and Unix shell, I made a few mistakes</a>. I accidentally deleted /tmp folder. To restore it all you have to do is:</p>&#13;
<pre class="bash">mkdir /tmp&#13;
chmod 1777 /tmp&#13;
chown root:root /tmp&#13;
ls -ld /tmp</pre>&#13;
<h2>Locking a directory</h2>&#13;
<p>For privacy of my data I wanted to lock down /downloads on my file server. So I ran:</p>&#13;
<pre class="bash">chmod 0000 /downloads</pre>&#13;
<p>The root user can still has access and ls and cd commands will not work. To go back:</p>&#13;
<pre class="bash">chmod 0755 /downloads</pre>&#13;
<h2>Password protecting file in vim text editor</h2>&#13;
<p>Afraid that root user or someone may snoop into your personal text files? Try password protection to a file in vim, type:</p>&#13;
<pre class="bash">&#160;&#13;
vim +X filename&#13;
&#160;</pre>&#13;
<p>Or, before quitting in vim use&#160;:X&#160;vim command to encrypt your file and vim will prompt for a password.</p>&#13;
<h2>Clear gibberish all over the screen</h2>&#13;
<p>Just type:</p>&#13;
<pre class="bash">&#160;&#13;
reset</pre>&#13;
<h2>Becoming human</h2>&#13;
<p>Pass the&#160;-h&#160;or&#160;-H&#160;(and other options) command line option to GNU or BSD utilities to get output of command commands like ls, df, du, in human-understandable formats:</p>&#13;
<pre class="bash">&#160;&#13;
ls -lh&#13;
# print sizes in human readable format (e.g., 1K 234M 2G)&#13;
df -h&#13;
df -k&#13;
# show output in bytes, KB, MB, or GB&#13;
free -b&#13;
free -k&#13;
free -m&#13;
free -g&#13;
# print sizes in human readable format (e.g., 1K 234M 2G)&#13;
du -h&#13;
# get file system perms in human readable format&#13;
stat -c %A /boot&#13;
# compare human readable numbers&#13;
sort -h -a file&#13;
# display the CPU information in human readable format on a Linux&#13;
lscpu&#13;
lscpu -e&#13;
lscpu -e=cpu,node&#13;
# Show the  size of each file but in a more human readable way&#13;
tree -h&#13;
tree -h /boot&#13;
&#160;</pre>&#13;
<h2>Show information about known users in the Linux based system</h2>&#13;
<p>Just type:</p>&#13;
<pre class="bash">## linux version ##&#13;
lslogins&#13;
&#160;&#13;
## BSD version ##&#13;
logins&#13;
&#160;</pre>&#13;
<p>Sample outputs:</p>&#13;
<pre>UID USER      PWD-LOCK PWD-DENY LAST-LOGIN GECOS&#13;
  0 root             0        0   22:37:59 root&#13;
  1 bin              0        1            bin&#13;
  2 daemon           0        1            daemon&#13;
  3 adm              0        1            adm&#13;
  4 lp               0        1            lp&#13;
  5 sync             0        1            sync&#13;
  6 shutdown         0        1 2014-Dec17 shutdown&#13;
  7 halt             0        1            halt&#13;
  8 mail             0        1            mail&#13;
 10 uucp             0        1            uucp&#13;
 11 operator         0        1            operator&#13;
 12 games            0        1            games&#13;
 13 gopher           0        1            gopher&#13;
 14 ftp              0        1            FTP User&#13;
 27 mysql            0        1            MySQL Server&#13;
 38 ntp              0        1&#13;
 48 apache           0        1            Apache&#13;
 68 haldaemon        0        1            HAL daemon&#13;
 69 vcsa             0        1            virtual console memory owner&#13;
 72 tcpdump          0        1&#13;
 74 sshd             0        1            Privilege-separated SSH&#13;
 81 dbus             0        1            System message bus&#13;
 89 postfix          0        1&#13;
 99 nobody           0        1            Nobody&#13;
173 abrt             0        1&#13;
497 vnstat           0        1            vnStat user&#13;
498 nginx            0        1            nginx user&#13;
499 saslauth         0        1            "Saslauthd user"</pre>&#13;
<h2>How do I fix mess created by accidentally untarred files in the current dir?</h2>&#13;
<p>So I accidentally untar a tarball in /var/www/html/ directory instead of /home/projects/www/current. It created mess in /var/www/html/. The easiest way to fix this mess:</p>&#13;
<pre class="bash">&#160;&#13;
cd /var/www/html/&#13;
/bin/rm -f "$(tar ztf /path/to/file.tar.gz)"&#13;
&#160;</pre>&#13;
<h2>Confused on a top command output?</h2>&#13;
<p>Seriously, you need to try out htop instead of top:</p>&#13;
<pre class="bash">sudo htop</pre>&#13;
<h2>Want to run the same command again?</h2>&#13;
<p>Just type&#160;!!. For example:</p>&#13;
<pre class="bash">&#160;&#13;
/myhome/dir/script/name arg1 arg2&#13;
&#160;&#13;
# To run the same command again &#13;
!!&#13;
&#160;&#13;
## To run the last command again as root user&#13;
sudo !!&#13;
&#160;</pre>&#13;
<p>The&#160;!!&#160;repeats the most recent command. To run the most recent command beginning with "foo":</p>&#13;
<pre class="bash">!foo&#13;
# Run the most recent command beginning with "service" as root&#13;
sudo !service</pre>&#13;
<p>The&#160;!$&#160;use to run command with the last argument of the most recent command:</p>&#13;
<pre class="bash"># Edit nginx.conf&#13;
sudo vi /etc/nginx/nginx.conf&#13;
&#160;&#13;
# Test nginx.conf for errors&#13;
/sbin/nginx -t -c /etc/nginx/nginx.conf&#13;
&#160;&#13;
# After testing a file with "/sbin/nginx -t -c /etc/nginx/nginx.conf", you&#13;
# can edit file again with vi&#13;
sudo vi !$</pre>&#13;
<h2>Get a reminder you when you have to leave</h2>&#13;
<p>If you need a reminder to leave your terminal, type the following command:</p>&#13;
<pre class="bash">&#160;&#13;
leave +hhmm&#13;
&#160;</pre>&#13;
<p>Where,</p>&#13;
<ul>&#13;
<li>hhmm&#160;- The time of day is in the form hhmm where hh is a time in hours (on a 12 or 24 hour clock), and mm are minutes. All times are converted to a 12 hour clock, and assumed to be in the next 12 hours.</li>&#13;
</ul>&#13;
<h2>Home sweet home</h2>&#13;
<p>Want to go the directory you were just in? Run:<br><code>cd -</code><br>Need to quickly return to your home directory? Enter:<br><code>cd</code><br>The variable&#160;CDPATH&#160;defines the search path for the directory containing directories:</p>&#13;
<pre class="bash">export CDPATH=/var/www:/nas10</pre>&#13;
<p>Now, instead of typing&#160;cd /var/www/html/&#160;I can simply type the following to cd into /var/www/html path:</p>&#13;
<pre class="bash">cd html</pre>&#13;
<h2>Editing a file being viewed with less pager</h2>&#13;
<p>To edit a file being viewed with less pager, press&#160;v. You will have the file for edit under $EDITOR:</p>&#13;
<pre class="bash">&#160;&#13;
less *.c&#13;
less foo.html&#13;
## Press v to edit file ##&#13;
## Quit from editor and you would return to the less pager again ##&#13;
&#160;</pre>&#13;
<h2>List all files or directories on your system</h2>&#13;
<p>To see all of the directories on your system, run:</p>&#13;
<pre class="bash">find / -type d | less&#13;
&#160;&#13;
# List all directories in your $HOME&#13;
find $HOME -type d -ls | less</pre>&#13;
<p>To see all of the files, run:</p>&#13;
<pre class="bash">find / -type f | less&#13;
&#160;&#13;
# List all files in your $HOME&#13;
find $HOME -type f -ls | less</pre>&#13;
<h2>Build directory trees in a single command</h2>&#13;
<p>You can create directory trees one at a time using mkdir command by passing the&#160;-p&#160;option:</p>&#13;
<pre class="bash">mkdir -p /jail/{dev,bin,sbin,etc,usr,lib,lib64}&#13;
ls -l /jail/</pre>&#13;
<h2>Copy file into multiple directories</h2>&#13;
<p>Instead of running:</p>&#13;
<pre class="bash">cp /path/to/file /usr/dir1&#13;
cp /path/to/file /var/dir2&#13;
cp /path/to/file /nas/dir3</pre>&#13;
<p>Run the following command to copy file into multiple dirs:</p>&#13;
<pre class="bash">echo /usr/dir1 /var/dir2 /nas/dir3 |  xargs -n 1 cp -v /path/to/file</pre>&#13;
<p><a href="http://bash.cyberciti.biz/guide/Writing_your_first_shell_function">Creating a shell function</a>&#160;is left as an exercise for the reader</p>&#13;
<h2>Quickly find differences between two directories</h2>&#13;
<p>The diff command compare files line by line. It can also compare two directories:</p>&#13;
<pre class="bash">ls -l /tmp/r&#13;
ls -l /tmp/s&#13;
# Compare two folders using diff ##&#13;
diff /tmp/r/ /tmp/s/</pre>&#13;
<h2>Text formatting</h2>&#13;
<p>You can reformat each paragraph with fmt command. In this example, I'm going to reformat file by wrapping overlong lines and filling short lines:</p>&#13;
<pre class="bash">fmt file.txt</pre>&#13;
<p>You can also split long lines, but do not refill i.e. wrap overlong lines, but do not fill short lines:</p>&#13;
<pre class="bash">fmt -s file.txt</pre>&#13;
<h2>See the output and write it to a file</h2>&#13;
<p>Use the tee command as follows to see the output on screen and also write to a log file named my.log:</p>&#13;
<pre class="bash">mycoolapp arg1 arg2 input.file | tee my.log</pre>&#13;
<p>The tee command ensures that you will see mycoolapp output on on the screen and to a file same time.</p>&#13;
</div>

<p class="info">
<h4>
Posted Mon 18 May 2015
 by <a class="url fn" href="./author/itech001.html">itech001</a>
in <a href="./category/zhong-wen.html">中文</a>
</h4></p>

</article>
</div>
<!-- /Content -->

<!-- Side bar -->
<nav class="col-lg-3">

<h2>分类</h2>
<ul class="nav nav-pills nav-stacked">
  <li ><a href="./category/ciandcd.html">ciandcd</a></li>
  <li ><a href="./category/devops.html">devops</a></li>
  <li ><a href="./category/scm.html">scm</a></li>
  <li class="active"><a href="./category/zhong-wen.html">中文</a></li>
</ul>

<ul class="tagcloud">
</ul>

<h2>链接</h2>
<ul class="nav nav-pills nav-stacked">
  <li><a href="http://www.cnblogs.com/itech/">itech</a></li>
</ul>

<h2>联系</h2>
<ul class="nav nav-pills nav-stacked">
  <li><a href="http://www.ciandcd.com/feeds/rss.xml" type="application/rss+xml" rel="alternate">Site Feed</a></li>
  <li><a href="https://github.com/ciandcd">Github</a></li>
</ul>

</nav>
<!-- /Side bar -->

</div>
<!-- /Main block -->

<!-- Footer -->
<div class="row"><div class="col-lg-12">
<footer><small>
Built using <a href="http://pelican.notmyidea.org/">Pelican</a> and
<a href="http://twitter.github.com/bootstrap">Bootstrap</a>.
</small></footer>
</div></div>
<!-- /Footer -->

</div></section>
<!-- /Body -->

<script src="./theme/js/jquery.js"></script>
<script src="./theme/js/bootstrap.js"></script>


</body>
</html>